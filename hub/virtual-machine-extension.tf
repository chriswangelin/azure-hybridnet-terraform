resource "azurerm_virtual_machine_extension" "dns_vm_001_customscript_vmext" {
  name                 = "dns_vm_001_customscript"
  virtual_machine_id   = module.dns_vm_001.vm_id
  publisher            = "Microsoft.Azure.Extensions"
  type                 = "CustomScript"
  type_handler_version = "2.0"

  settings = <<SETTINGS
  {
    "script": "IyBVcGRhdGUgcGFja2FnZXMKeXVtIHVwZGF0ZSAteQp5dW0gdXBncmFkZSAteQoKIyBJbnN0YWxsIEROUyBwYWNrYWdlcwp5dW0gaW5zdGFsbCB1bmJvdW5kIC15CiAKICMgSW5pdGlhbGl6ZSB1bmJvdW5kIGxvZyBmaWxlCiB0b3VjaCAvdmFyL2xvZy91bmJvdW5kLmxvZwogY2hvd24gdW5ib3VuZDp1bmJvdW5kIC92YXIvbG9nL3VuYm91bmQubG9nCiAjIFNldCBzZWxpbnV4IGZpbGUgdHlwZSB0byBuYW1lZF9sb2dfdCB0eXBlCiBzZW1hbmFnZSBmY29udGV4dCAtYSAtdCBuYW1lZF9sb2dfdCAiL3Zhci9sb2cvdW5ib3VuZC5sb2ciCiAjIEFwcGx5IHRoZSBjaGFuZ2VzCiByZXN0b3JlY29uIC12IC92YXIvbG9nL3VuYm91bmQubG9nCgoKIyBDb25maWd1cmUgdW5ib3VuZCBETlMKY3AgLXAgL2V0Yy91bmJvdW5kL3VuYm91bmQuY29uZiAvZXRjL3VuYm91bmQvdW5ib3VuZC5jb25mLm9yaWcKY2F0ID4gL2V0Yy91bmJvdW5kL3VuYm91bmQuY29uZiA8PCBFT0YKc2VydmVyOgogIGNocm9vdDogIiIKICBsb2dmaWxlOiAvdmFyL2xvZy91bmJvdW5kLmxvZwogIHZlcmJvc2l0eTogMQogIGxvZy1xdWVyaWVzOiB5ZXMKICAgIGludGVyZmFjZTogMC4wLjAuMAogICAgICBhY2Nlc3MtY29udHJvbDogMTAuMC4wLjAvMTYgYWxsb3cKICAgICAgYWNjZXNzLWNvbnRyb2w6IDE3Mi4xNi4wLjAvMTYgYWxsb3cKICAgICAgdmVyYm9zaXR5OiAxCgogIGZvcndhcmQtem9uZToKICAgIG5hbWU6ICJvbnByZW0ubmV0LiIKICAgIGZvcndhcmQtYWRkcjogMTcyLjE2LjI1NC40ICAgIyBvbi1wcmVtIEROUwoKICBmb3J3YXJkLXpvbmU6CiAgICBuYW1lOiAiLiIKICAgIGZvcndhcmQtYWRkcjogMTY4LjYzLjEyOS4xNiAgICMgQXp1cmUgcmVzb2x2ZXIKRU9GCgojIENvbmZpZ3VyZSBmaXJld2FsbCB0byBhbGxvdyBETlMgbG9va3VwcwpmaXJld2FsbC1jbWQgLS16b25lPXB1YmxpYyAtLWFkZC1zZXJ2aWNlIGRucyAtLXBlcm1hbmVudApmaXJld2FsbC1jbWQgLS1yZWxvYWQKCiMgRGlzYWJsZSBOZXR3b3JrTWFuYWdlciBjb250cm9sIG9mIC9ldGMvcmVzb2x2LmNvbmYKY2F0ID4gL2V0Yy9OZXR3b3JrTWFuYWdlci9jb25mLmQvOTAtZG5zLW5vbmUuY29uZiA8PCBFT0YKW21haW5dCmRucz1ub25lCkVPRgoKIyBTZXQgbmFtZXNlcnZlciB0byBsb2NhbCBob3N0CmVjaG8gIm5hbWVzZXJ2ZXIgMTI3LjAuMC4xIiA+IC9ldGMvcmVzb2x2LmNvbmYgCgoKIyBDb25maXVndXJlIGV0aDAgdG8gdXNlIGxvY2FsIHVuYm91bmQgc2VydmljZSBmb3IgRE5TIGxvb2t1cHMKbm1jbGkgY29uIG1vZCAiU3lzdGVtIGV0aDAiIGlwdjQuaWdub3JlLWF1dG8tZG5zIHRydWUKbm1jbGkgY29uIG1vZCAiU3lzdGVtIGV0aDAiIGlwdjQuZG5zIDEyNy4wLjAuMQpzeXN0ZW1jdGwgcmVsb2FkIE5ldHdvcmtNYW5hZ2VyCgojIEVuYWJsZSBhbmQgc3RhcnQgdW5ib3VuZApzeXN0ZW1jdGwgZW5hYmxlIHVuYm91bmQKc3lzdGVtY3RsIHN0YXJ0IHVuYm91bmQKc3lzdGVtY3RsIHN0YXR1cyB1bmJvdW5k"
  }
SETTINGS
}
